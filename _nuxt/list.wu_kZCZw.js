import{u as S,_ as F}from"./event.5tGgLFGj.js";import{H as I,o as _,c as H,a as A,h as G,g as U,r,i as P,f as C,s as T,k as y,j as Y,l as q,b as i,m as l,w as f,M as O,$ as D,_ as J,n as K}from"./entry.UFj30woN.js";import{$ as Q}from"./emitter.pJSYLuLh.js";import{U as W}from"./UpOutlined.lWHrYK3t.js";import{f as b}from"./find.cnruyxRx.js";import{f as X}from"./forEach.FG_PwuZQ.js";import{_ as Z}from"./Affix.ineUxGGm.js";import{N as ee}from"./Icon.2XnlusKt.js";import"./nuxt-link.Acpmzmv-.js";import"./_plugin-vue_export-helper.x3n3nnut.js";import"./use-compitable.DJW_dfQ1.js";import"./format-length.4l65r8M5.js";const te={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},oe=A("path",{d:"M880.1 154H143.9c-24.5 0-39.8 26.7-27.5 48L349 597.4V838c0 17.7 14.2 32 31.8 32h262.4c17.6 0 31.8-14.3 31.8-32V597.4L907.7 202c12.2-21.3-3.1-48-27.6-48zM603.4 798H420.6V642h182.9v156zm9.6-236.6l-9.5 16.6h-183l-9.5-16.6L212.7 226h598.6L613 561.4z",fill:"currentColor"},null,-1),se=[oe],ae=I({name:"FilterOutlined",render:function(d,g){return _(),H("svg",te,se)}}),he={__name:"list",async setup($){let d,g;const a=G(),w=U(),L=r(null);let h=r([]),c=r(!0),u=r(!1),v=r(!1),o=P({page:a.params.page||1,area:a.params.area||"all",subject:a.params.subject||"all",progress:a.params.progress||"all",order:a.params.order||"hot"});const x=a.params.page||1,z=C.cata(),B=C.glob(),{list:j}=T(z),{conf:R}=T(B),{public:E}=K();S(window,"scroll",async()=>{let e=document.documentElement.scrollTop||document.body.scrollTop||window.pageYOffset,s=document.documentElement.clientHeight,n=document.documentElement.scrollHeight;e+s>=n-32&&await k(),e<10?c.value=!0:c.value=!1});const V=y(()=>R.value.area),M=y(()=>e=>j.value.length>0?b(j.value,{alias:e}).children:[]);Y({title:()=>{const e=V.value[o.area],s=b(M.value("subject"),{alias:o.subject}),n=b(E.progress,{val:o.progress});let m={hot:"最热",last:"最新"},t=[];e&&t.push(e.label),s&&t.push(s.title),n&&t.push(n.label),t.length>0&&t.unshift(m[o.order]);let p=t.join(",");return`${p?p+",":""}${x>1?"第"+x+"页,":""}${E.metaTitle}`}});const k=async()=>{if(v.value||u.value)return!1;u.value=!0,w.start();const e=await D.get("comic/index",o);e&&(o.page===1&&h.value.splice(0),e.result.length>0?(X(e.result,s=>{h.value.push(s)}),o.page++):v.value=!0),w.finish(),u.value=!1},N=()=>{c.value?Q().emit("FILTER_TOGGLE"):window.scrollTo({top:0,left:0,behavior:"smooth"})};return[d,g]=q(()=>k()),await d,g(),(e,s)=>{const n=F,m=ee,t=J,p=Z;return _(),H("div",{class:"container-full flex-col align-items-center header-mt-def",ref_key:"mainRef",ref:L},[i(n,{isEnd:l(v),isLoading:l(u),comicList:l(h)},null,8,["isEnd","isLoading","comicList"]),i(p,{bottom:80,"trigger-bottom":80,"listen-to":()=>L.value,style:{right:"10px"}},{default:f(()=>[i(t,{circle:"",size:"large",class:"mr-10",onClick:N,color:"#ffd100","text-color":"#000"},{default:f(()=>[l(c)?(_(),O(m,{key:0,size:"22"},{default:f(()=>[i(l(ae))]),_:1})):(_(),O(m,{key:1,size:"22"},{default:f(()=>[i(l(W))]),_:1}))]),_:1})]),_:1},8,["listen-to"])],512)}}};export{he as default};
